<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Todo List App</title>
  </head>
  <body>
    <div id="todo">
      <header>
        <h1>Todo List - ìˆ˜ì • :)</h1>
        <p>íŒŒì¼ ê²½ë¡œ: <span id="filepath"></span></p>
      </header>
      <div id="main">
        <div id="container">
          <ul>
            <li>
              <h2>ì‡¼í•‘ ëª©ë¡</h2>
              <div class="todoinput">
                <input type="text" autofocus onkeyup="handleAddKeyup(event)" />
                <button type="button" onclick="handleAdd()">ì¶”ê°€</button>
              </div>
              <ul class="todolist">
                <li>
                  <span>1</span>
                  <span><s>ìƒ˜í”Œ1</s></span>
                  <button type="button">ì‚­ì œ</button>
                </li>
                <li>
                  <span>2</span>
                  <span>ìƒ˜í”Œ2</span>
                  <button type="button">ì‚­ì œ</button>
                </li>
                <li>
                  <span>3</span>
                  <span>ìƒ˜í”Œ3</span>
                  <button type="button">ì‚­ì œ</button>
                </li>
              </ul>
            </li>
          </ul>
        </div>
      </div>
      <footer>
        <p>ë©‹ìŸì´ ì‚¬ìì²˜ëŸ¼ FrontEnd BootCamp</p>
      </footer>
    </div>

    <script type="text/javascript">
      // http://localhost:5500/workspace-ins/ch01-buildup/todolist/sample/
      // ['http://localhost:5500/workspace-ins/', '/ch01-buildup/todolist/sample/']
      document.querySelector('#filepath').textContent = `ch${document.URL.split('/ch')[1]}index.html`;

      // ìƒ˜í”Œ ëª©ë¡
      const itemList = [
        { no: 1, title: 'ë‘ë¶€', done: true} ,
        { no: 2, title: 'ê³„ë€', done: false },
        { no: 3, title: 'ë¼ë©´', done: true },
      ];

      // ul ìš”ì†Œ
      const todolistEl = document.querySelector('.todolist');

      // ê¸°ì¡´ ëª©ë¡ ì‚­ì œ
      while(todolistEl.firstChild) {
        todolistEl.firstChild.remove();
      }

      // ItemList ë°°ì—´ì˜ ê° todo ì•„ì´í…œì„ í™”ë©´ì— ì¶”ê°€
      itemList.forEach((item, i) => {
        const liEl = getTodoItemElem(item);

        todolistEl.appendChild(liEl)
      })

      // í•œ ê±´ì˜ Todo ê°ì²´ë¥¼ ë°›ì•„ì„œ âœ¨DOM ê°ì²´ë¡œ ë§Œë“¤ì–´âœ¨ ë°˜í™˜
      function getTodoItemElem(item){
        // ğŸ”´
        // return (`
        // âœ¨ data attribute ì¶”ê°€!(ë¦¬ìŠ¤íŠ¸ë§ˆë‹¤ì˜ ê³ ìœ í•œ ë„˜ë²„ë¥¼ ê°–ë„ë¡)
        //     <li data-no="1">
        //       <span>1</span>
        //       <span onclick="toggleDone(1)"><s>ìƒ˜í”Œ1</s></span>
        //       <button type="button">ì‚­ì œ</button>
        //     </li>
        // `)

        // ë” ìš”ì†Œë“¤ ìƒì„±
        // <li></li> ìƒì„±
        const liElem = document.createElement('li');
        // <span> ìƒì„±
        const noElem = document.createElement('span');
        // <span> ìƒì„±
        const titleElem = document.createElement('span');
        // <button></button> ìƒì„±
        const deleteElem = document.createElement('button');


        // í…ìŠ¤íŠ¸ ë…¸ë“œë“¤ ìƒì„±
        // 1
        const noTxt = document.createTextNode(item.no);
        // ìƒ˜í”Œ1
        const titleTxt = document.createTextNode(item.title);
        // ì‚­ì œ
        const deleteTxt = document.createTextNode('ì‚­ì œ');

        // <span>1</span>
        noElem.appendChild(noTxt);

        // <span><s>ìƒ˜í”Œ1</s></span>
        if (item.done) {
            // ì™„ë£Œëœ ê²ƒë“¤ -> cross out
            const sElem = document.createElement('s');
            // <s>ìƒ˜í”Œ1</s>
            sElem.appendChild(titleTxt);
            // <span><s>ìƒ˜í”Œ1</s></span>
            titleElem.appendChild(sElem);
        } else {
            // ë¯¸ì™„ë£Œ (<span>ìƒ˜í”Œ1</span>)
            titleElem.appendChild(titleTxt);
        }

        // <button type="button">ì‚­ì œ</button>
        deleteElem.setAttribute('type', 'button');
        deleteElem.appendChild(deleteTxt);

        // <li></li>ì— <span> ë‘ ê°œ ì¶”ê°€, <button>ë„ ì¶”ê°€
        liElem.appendChild(noElem);
        liElem.appendChild(titleElem);
        liElem.appendChild(deleteElem);

        // âœ¨data attribute ì¶”ê°€!
        liElem.setAttribute('data-no', item.no)
        // titleElì„ í´ë¦­í–ˆì„ ë•Œ cross outë˜ì–´ì•¼ í•˜ë¯€ë¡œ, í´ë¦­ ì´ë²¤íŠ¸ ì¶”ê°€!
        titleElem.setAttribute('onclick', `toggleDone(${item.no})`)

        return liElem;
      }

      // "ì¶”ê°€"ë²„íŠ¼ í´ë¦­í–ˆì„ ë•Œ, í˜¸ì¶œë˜ëŠ” ì´ë²¤íŠ¸
      const handleAdd = () => {
        const inputElem = document.querySelector('.todoinput > input');
        if (inputElem.value.trim() !== '') {
          addItem(inputElem.value);
          inputElem.value = '';
          inputElem.focus();
        }
      };

      // ì—”í„° ì³¤ì„ ë•Œ, í˜¸ì¶œë˜ëŠ” ì´ë²¤íŠ¸
      const handleAddKeyup = (event) => {
        if(event.key === 'Enter') handleAdd();
      }

      // í• ì¼ ì¶”ê°€
      function addItem(title){
        const item = {
          no: itemList[itemList.length - 1].no + 1,
          title,
          done: false,
        }

        // TODO: ë°ì´í„° ê°±ì‹ í•˜ëŠ” ì‘ì—… (ì¼ë‹¨ ì½”ë“œ ìƒì˜ ì›ë³¸ ë°ì´í„°(=itemList)ì— ë³€í™”ë¥¼ ì£¼ê³ , ì¦‰ ìƒˆë¡­ê²Œ ë“±ë¡ëœ ë°ì´í„°ë¥¼ ì¶”ê°€(push)í•˜ê³ ,)
        itemList.push(item);

        // TODO: í™”ë©´ì„ ê°±ì‹  (í™”ë©´ì—ë„ ìƒˆë¡­ê²Œ ì¶”ê°€ëœ ë¦¬ìŠ¤íŠ¸ë¥¼ ì¶”ê°€í•¨ìœ¼ë¡œì¨ ë³€í™”ë¥¼ ì¤˜ì•¼ í•œë‹¤.)
        const liElem = getTodoItemElem(item);
        const todolistElem = document.querySelector('.todolist');
        todolistElem.appendChild(liElem);
      }

      // ì™„ë£Œ/ë¯¸ì™„ë£Œ ì²˜ë¦¬
      function toggleDone(no){
        // let selectedItem;
        // itemList.forEach(item => {
        //   if (item.no === no) {
        //     selectedItem = item;
        //   }
        // });

        // TODO: ë°ì´í„° ê°±ì‹  1ï¸âƒ£
        let selectedItem = itemList.find(item => item.no === no);
        selectedItem.done = !selectedItem.done;

        // TODO: í™”ë©´ ê°±ì‹  2ï¸âƒ£
        const selectedLiElem = document.querySelector(`.todolist > li[data-no="${ no }"]`);
        // <li data-no="1">
        //  <span>1</span>
        //  <span>ìƒ˜í”Œ1</span>
        //  <button type="button">ì‚­ì œ</button>
        // </li>

        // ğŸ“Œ children: ìš”ì†Œ ë…¸ë“œë§Œ ì„ íƒí•©ë‹ˆë‹¤. í…ìŠ¤íŠ¸ë‚˜ ì£¼ì„ ë…¸ë“œëŠ” í¬í•¨ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
        const titleSpanElem = selectedLiElem.children[1];
        if (selectedItem.done) {
          // <span>ìƒ˜í”Œ1</span> -> <span><s>ìƒ˜í”Œ1</s></span> : <s> ì¶”ê°€
          const sElem = document.createElement('s');
          // ğŸ’« appendChildëŠ” ë³µì‚¬ê°€ ì•„ë‹Œ, ì´ë™ì˜ ì—­í• ì„ í•˜ë¯€ë¡œ, ë”°ë¡œ titleì„ removeí•  í•„ìš”ëŠ” ì—†ë‹¤!

          // ğŸ“Œ ëª¨ë“  ìì‹ ë…¸ë“œ(ìš”ì†Œ, í…ìŠ¤íŠ¸, ì£¼ì„ ë“±)ì„ í¬í•¨í•˜ë©°, ì²« ë²ˆì§¸ ìì‹ ë…¸ë“œë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤. ëª¨ë“  ë…¸ë“œë¥¼ í¬í•¨í•˜ê¸° ë•Œë¬¸ì—, ê·¸ëƒ¥ í…ìŠ¤íŠ¸ ë…¸ë“œì¼ ìˆ˜ë„, ìš”ì†Œ ë…¸ë“œì¼ ìˆ˜ë„ ìˆë‹¤.
          // âœ… ë”°ë¼ì„œ, firstChildëŠ” í…ìŠ¤íŠ¸ ë…¸ë“œë„ í¬í•¨í•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì—, ìš”ì†Œ ë…¸ë“œë§Œ ì„ íƒí•˜ê³  ì‹¶ë‹¤ë©´ childrenì„ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ë” ì í•©í•©ë‹ˆë‹¤.
          sElem.appendChild(titleSpanElem.firstChild);
          titleSpanElem.appendChild(sElem);
        } else {
          // <span><s>ìƒ˜í”Œ1</s></span> -> <span>ìƒ˜í”Œ1</span> : <s> ì‚­ì œ
          titleSpanElem.appendChild(titleSpanElem.children[0].firstChild);
          // ğŸ‘€ ìœ„ì˜ ë§¤ê°œë³€ìˆ˜ëŠ” titleSpanElem.firstChild.firstChildì™€ ê°™ì€ ì½”ë“œ
          // ë‹¨ì§€, children[0]ì„ ì¨ì¤Œìœ¼ë¡œì¨, í…ìŠ¤íŠ¸ì™€ ì£¼ì„ë…¸ë“œë¥¼ ì œì™¸í•œ, ì˜¤ì§ ìš”ì†Œë…¸ë“œë§Œì„ HTMLCollectionìœ¼ë¡œë¶€í„° ë½‘ëŠ”ë‹¤ëŠ” ì˜ë¯¸ë¥¼ ë‚˜íƒ€ë‚¼ ìˆ˜ ìˆì–´ì„œ ê°€ë…ì„± Good.
          //(âˆµ <span> ìš”ì†Œ ì•ˆì— ìˆëŠ” <s>ìš”ì†Œë¥¼ ì„ íƒ í›„,(children[0]) ê·¸ ì•ˆì— ìˆëŠ” í…ìŠ¤íŠ¸ë…¸ë“œ(firstChild) ì„ íƒí•˜ëŠ” ê²ƒì´ë¯€ë¡œ..)
          titleSpanElem.firstChild.remove();

          // âœ… ì•Œì•„ë‘ë©´ ì¢‹ì„ children ë©”ì†Œë“œ ì‚¬ìš©ë²•!
          // 1ï¸âƒ£ childrenì€ í•­ìƒ ë’¤ì— ì¸ë±ìŠ¤ë¥¼ ì¨ì¤˜ì•¼ í•©ë‹ˆë‹¤. ê·¸ ì´ìœ ëŠ” childrenì´ HTMLCollectionì„ ë°˜í™˜í•˜ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤. HTMLCollectionì€ ë°°ì—´ì²˜ëŸ¼ ë³´ì´ì§€ë§Œ, ì‚¬ì‹¤ ë°°ì—´ì´ ì•„ë‹ˆë©°, ì¸ë±ìŠ¤ë¥¼ í†µí•´ ê° ìš”ì†Œì— ì ‘ê·¼í•´ì•¼ í•©ë‹ˆë‹¤.
          // 2ï¸âƒ£ HTMLCollectionì€ ë°°ì—´ì²˜ëŸ¼ ì¸ë±ìŠ¤ë¥¼ ì‚¬ìš©í•´ ìì‹ ìš”ì†Œì— ì ‘ê·¼í•  ìˆ˜ ìˆì§€ë§Œ, ì‚¬ì‹¤ìƒ ë°°ì—´ì€ ì•„ë‹ˆê¸° ë•Œë¬¸ì— ë°°ì—´ ë©”ì„œë“œ (map, ğŸ’¥forEach ë“±)ëŠ” ì‚¬ìš©í•  ìˆ˜ ì—†ê³ , ì¸ë±ìŠ¤ë¥¼ ì‚¬ìš©í•´ì„œ ì ‘ê·¼í•´ì•¼ í•©ë‹ˆë‹¤.
          // ğŸ’¥ HTMLCollectionì—ì„œ forEach() ë©”ì„œë“œë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤ëŠ” ì ì€ íŠ¹ë³„í•œ ì˜ˆì™¸ì…ë‹ˆë‹¤. ì‚¬ì‹¤, HTMLCollectionì€ ë°°ì—´ì´ ì•„ë‹ˆì§€ë§Œ, ìµœì‹  ë¸Œë¼ìš°ì €ì—ì„œëŠ” forEach() ë©”ì„œë“œë¥¼ ì§€ì›í•œë‹¤. êµ¬ë²„ì „ì˜ ë¸Œë¼ìš°ì €ì—ì„œëŠ” ë™ì‘í•˜ì§€ ì•Šì„ ìˆ˜ ìˆëŠ”ë°, ì´ëŸ´ ê²½ìš°, forEach()ë¥¼ ì‚¬ìš©í•˜ë ¤ë©´ Array.from()ì´ë‚˜ ìŠ¤í”„ë ˆë“œ ì—°ì‚°ì [...]ë¥¼ ì´ìš©í•´ ë°°ì—´ë¡œ ë³€í™˜ í›„, forEach()ë¥¼ ì‚¬ìš©í•´ì•¼ í•œë‹¤.
        }
      }

      // í• ì¼ ì‚­ì œ
      function deleteItem(no){

      }
    </script>
  </body>
</html>
